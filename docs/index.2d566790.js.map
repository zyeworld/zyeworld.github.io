{"mappings":"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","sources":["src/components/nav/nav.ts"],"sourcesContent":["// implements pattern lock feature into nav\n// a lot of easter eggs may be added in the future here...\n\n(function () {\n  /* elements & config */\n  const canvas = document.getElementById(\"nav-pattern\") as HTMLCanvasElement;\n  const ctx = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\n  const pattern_dot_container = document.querySelector(\n    \"#nav-dots > ol\"\n  ) as Element;\n  const pattern_dots = pattern_dot_container.children;\n\n  const config = {\n    classes: {\n      dot_focus: \"focus\",\n      dot_wrong: \"wrong\",\n      nav_small: \"small\"\n    },\n    colors: {\n      default: \"white\",\n      wrong: \"rgb(255, 140, 140)\"\n    },\n    pattern: {\n      three_dot_lines: [\n        /* list of 3 dots that create a line */\n        [0, 1, 2] /* → */,\n        [3, 4, 5],\n        [6, 7, 8],\n        [0, 3, 6] /* ↓ */,\n        [1, 4, 7],\n        [2, 5, 8],\n        [0, 4, 8] /* ↘︎ */,\n        [2, 4, 6] /* ↙︎ */\n      ],\n      valid_patterns: [\n        /* use [1-9] here instead of [0-8] */\n        { valid_pattern: 541263789, link: \"/projects\" },\n        { valid_pattern: 183526794, link: \"/projects/pattern\" }\n      ],\n      wrong_timeout_ms: 1000\n    }\n  };\n\n  /* ******************************************************* */\n  /* variables */\n\n  /* pattern can be drawn only if enabled */\n  let enabled: boolean = true;\n  let wrong_timeoutId: number | null = null;\n\n  const dot_xs: number[] = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n  const dot_ys: number[] = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n  let dot_r: number = 0;\n  let dot_under_mouse: number | null = null;\n\n  let line_width: number = 0;\n  let line_color: string = config.colors.default;\n\n  let mousedown: boolean = false;\n  let mouse_x: number = 0;\n  let mouse_y: number = 0;\n\n  const pattern: number[] = [];\n\n  const is_dot_used: boolean[] = [\n    false,\n    false,\n    false,\n    false,\n    false,\n    false,\n    false,\n    false,\n    false\n  ];\n\n  /* ******************************************************* */\n  /* handling dots */\n\n  function update_dots(): void {\n    let rect = pattern_dot_container.getBoundingClientRect();\n    let center_x = Math.floor((rect.left + rect.right) / 2);\n    let center_y = Math.floor((rect.top + rect.bottom) / 2);\n\n    /* x: 1 2 3 1 2 3 1 2 3\n       y: 1 1 1 2 2 2 3 3 3 */\n    for (let i = 0; i < 3; i++) {\n      dot_xs[3 * i] = rect.left;\n      dot_xs[3 * i + 1] = center_x;\n      dot_xs[3 * i + 2] = rect.right;\n\n      dot_ys[i] = rect.top;\n      dot_ys[3 + i] = center_y;\n      dot_ys[6 + i] = rect.bottom;\n    }\n\n    dot_r = Math.floor((rect.right - rect.left) * 0.18);\n    line_width = Math.floor((rect.right - rect.left) * 0.025);\n  }\n\n  function toggle_dot_focus(dot = 0, on = true): void {\n    if (on) {\n      pattern_dots[dot].classList.add(config.classes.dot_focus);\n    } else {\n      pattern_dots[dot].classList.remove(config.classes.dot_focus);\n    }\n  }\n\n  function toggle_dot_wrong(dot = 0, on = true): void {\n    if (on) {\n      /* could get animated in future (flicker?) */\n      pattern_dots[dot].classList.add(config.classes.dot_wrong);\n    } else {\n      pattern_dots[dot].classList.remove(config.classes.dot_wrong);\n    }\n  }\n\n  function coords_to_dot(x = 0, y = 0): number | null {\n    for (let dot = 0; dot < 9; dot++) {\n      let dx = x - dot_xs[dot];\n      let dy = y - dot_ys[dot];\n\n      if (dx * dx + dy * dy < dot_r * dot_r) {\n        return dot;\n      }\n    }\n    return null;\n  }\n\n  /* ******************************************************* */\n  /* drawing functions */\n\n  function draw_pattern(): void {\n    if (pattern.length <= 1) {\n      return;\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(dot_xs[pattern[0]], dot_ys[pattern[0]]);\n    for (let i = 1; i < pattern.length; i++) {\n      ctx.lineTo(dot_xs[pattern[i]], dot_ys[pattern[i]]);\n    }\n    ctx.stroke();\n  }\n\n  function draw_line_to_mouse(): void {\n    if (pattern.length === 0) {\n      return;\n    }\n\n    ctx.beginPath();\n    let dot_last = pattern[pattern.length - 1];\n    ctx.moveTo(dot_xs[dot_last], dot_ys[dot_last]);\n    ctx.lineTo(mouse_x, mouse_y);\n    ctx.stroke();\n  }\n\n  /* canvas animation step */\n  function draw(): void {\n    ctx.clearRect(0, 0, canvas.offsetWidth, canvas.offsetHeight);\n\n    ctx.lineWidth = line_width;\n    ctx.strokeStyle = line_color;\n    ctx.lineCap = \"round\";\n    ctx.lineJoin = \"round\";\n\n    draw_pattern();\n    if (mousedown) {\n      draw_line_to_mouse();\n    }\n  }\n\n  /* ******************************************************* */\n  /* handling the pattern */\n\n  function reset_pattern(): void {\n    is_dot_used.fill(false);\n    pattern.splice(0, pattern.length);\n\n    for (let i = 0; i < 9; i++) {\n      if (i !== dot_under_mouse) {\n        toggle_dot_focus(i, false);\n      }\n      toggle_dot_wrong(i, false);\n    }\n\n    line_color = config.colors.default;\n\n    /* cancel 'wrong pattern' timeout */\n    if (wrong_timeoutId !== null) {\n      clearTimeout(wrong_timeoutId);\n      wrong_timeoutId = null;\n    }\n  }\n\n  /* wrongenize the pattern */\n  function wrongify_pattern(): void {\n    for (let i = 0; i < 9; i++) {\n      if (is_dot_used[i]) {\n        toggle_dot_wrong(i, true);\n      }\n    }\n    line_color = config.colors.wrong;\n  }\n\n  function pattern_add(dot = 0): void {\n    if (is_dot_used[dot]) {\n      return;\n    }\n\n    if (pattern.length > 0) {\n      /* see if current and previous dot are endpoints of a three_dot_line */\n      let dot_prev = pattern[pattern.length - 1];\n\n      for (let line of config.pattern.three_dot_lines) {\n        if (is_dot_used[line[1]]) continue;\n\n        if (\n          (dot === line[0] && dot_prev === line[2]) ||\n          (dot === line[2] && dot_prev === line[0])\n        ) {\n          is_dot_used[line[1]] = true;\n          pattern.push(line[1]);\n          toggle_dot_focus(line[1], true);\n          break;\n        }\n      }\n    }\n\n    is_dot_used[dot] = true;\n    pattern.push(dot);\n    toggle_dot_focus(dot, true);\n  }\n\n  function pattern_to_number(): number {\n    /* [0, 1, 6, 4] => 1275 */\n    return pattern.reduce((total, cur) => total * 10 + (cur + 1), 0);\n  }\n\n  /* each valid pattern leads to a link */\n  function pattern_to_link(): string | null {\n    let pattern_code = pattern_to_number();\n\n    for (let { valid_pattern, link } of config.pattern.valid_patterns) {\n      if (pattern_code === valid_pattern) {\n        return link;\n      }\n    }\n    return null;\n  }\n\n  /* ******************************************************* */\n  /* handling mouse */\n\n  function on_mousedown(x = 0, y = 0): void {\n    if (!enabled || mousedown) {\n      return;\n    }\n    mouse_x = x;\n    mouse_y = y;\n\n    reset_pattern();\n\n    if (dot_under_mouse !== null) {\n      mousedown = true;\n      pattern_add(dot_under_mouse);\n    }\n\n    window.requestAnimationFrame(draw);\n  }\n\n  function on_mousemove(x = 0, y = 0): void {\n    if (!enabled) {\n      return;\n    }\n    mouse_x = x;\n    mouse_y = y;\n\n    let dot = coords_to_dot(mouse_x, mouse_y);\n\n    /* if mouse leaves dot: shrink */\n    if (dot_under_mouse !== null && dot_under_mouse !== dot) {\n      if (!is_dot_used[dot_under_mouse]) {\n        toggle_dot_focus(dot_under_mouse, false);\n      }\n      dot_under_mouse = null;\n    }\n    /* if mouse enters dot: enlarge */\n    if (dot !== null && dot_under_mouse === null) {\n      toggle_dot_focus(dot, true);\n      if (mousedown && !is_dot_used[dot]) {\n        pattern_add(dot);\n      }\n      dot_under_mouse = dot;\n    }\n\n    if (mousedown) {\n      window.requestAnimationFrame(draw);\n    }\n  }\n\n  function on_mouseup(): void {\n    if (!enabled || !mousedown) {\n      return;\n    }\n\n    mousedown = false;\n\n    /* ignore 'single dot patterns' */\n    if (pattern.length <= 1) {\n      reset_pattern();\n      window.requestAnimationFrame(draw);\n      return;\n    }\n\n    let link = pattern_to_link();\n\n    if (link === null) {\n      wrongify_pattern();\n      wrong_timeoutId = setTimeout(() => {\n        reset_pattern();\n        window.requestAnimationFrame(draw);\n      }, config.pattern.wrong_timeout_ms);\n    } else {\n      /* move to href */\n      window.location.href = link;\n    }\n\n    window.requestAnimationFrame(draw);\n  }\n\n  /* ******************************************************* */\n  /* event listeners */\n\n  canvas.addEventListener(\"mousedown\", function (e) {\n    on_mousedown(e.offsetX, e.offsetY);\n  });\n  canvas.addEventListener(\"touchstart\", function (e) {\n    on_mousedown(e.touches[0].clientX, e.touches[0].clientY);\n  });\n\n  canvas.addEventListener(\"mousemove\", function (e) {\n    on_mousemove(e.offsetX, e.offsetY);\n  });\n  canvas.addEventListener(\"touchmove\", function (e) {\n    on_mousedown(e.touches[0].clientX, e.touches[0].clientY);\n  });\n\n  canvas.addEventListener(\"mouseup\", function (e) {\n    on_mouseup();\n  });\n  canvas.addEventListener(\"touchend\", function (e) {\n    on_mouseup();\n  });\n\n  /* ******************************************************* */\n\n  window.addEventListener(\"load\", function (e) {\n    canvas.setAttribute(\"width\", canvas.offsetWidth.toString());\n    canvas.setAttribute(\"height\", canvas.offsetHeight.toString());\n    update_dots();\n    window.requestAnimationFrame(draw);\n  });\n\n  window.addEventListener(\"resize\", function (e) {\n    canvas.setAttribute(\"width\", canvas.offsetWidth.toString());\n    canvas.setAttribute(\"height\", canvas.offsetHeight.toString());\n    update_dots();\n    window.requestAnimationFrame(draw);\n  });\n})();\n"],"names":["canvas","document","getElementById","ctx","getContext","pattern_dot_container","querySelector","pattern_dots","children","config","classes","dot_focus","dot_wrong","nav_small","colors","default","wrong","pattern","three_dot_lines","valid_patterns","valid_pattern","link","wrong_timeout_ms","wrong_timeoutId","dot_xs","dot_ys","dot_r","dot_under_mouse","line_width","line_color","mousedown","mouse_x","mouse_y","is_dot_used","update_dots","rect","getBoundingClientRect","center_x","Math","floor","left","right","center_y","top","bottom","i","toggle_dot_focus","dot","on","classList","add","remove","toggle_dot_wrong","draw","clearRect","offsetWidth","offsetHeight","lineWidth","strokeStyle","lineCap","lineJoin","length","beginPath","moveTo","lineTo","stroke","draw_pattern","dot_last","draw_line_to_mouse","reset_pattern","fill","splice","clearTimeout","pattern_add","dot_prev","line","push","pattern_to_link","pattern_code","reduce","total","cur","on_mousedown","x","y","window","requestAnimationFrame","on_mousemove","dx","dy","coords_to_dot","on_mouseup","wrongify_pattern","setTimeout","location","href","addEventListener","e","offsetX","offsetY","touches","clientX","clientY","setAttribute","toString"],"version":3,"file":"index.2d566790.js.map"}